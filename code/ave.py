from meta import get_meta_paths,get_meta
import pandas as pd
import numpy as np
from time import time
from ml_robot import write_log
from malware_model import YCOL,IDCOL,METRIC

def ave():
    start = time()
    score = 0.702 
    xx = list(range(148,156))#+[222,223,225,227,231]
    #xx = [110,125]
    paths = get_meta_paths(xx)
    Xt,s = get_meta(paths,'sub')
    y = np.mean(Xt,axis=1)
    assert len(y) == s.shape[0]
    s[YCOL] = y
    s.to_csv('sub_meta.csv.gz',index=False,compression='gzip')#,float_format='%.4f')
    duration = time()-start
    write_log(duration,score,'meta search ng %s'%(str(xx)),mfiles=['sub_meta.csv.gz'])

if __name__ == '__main__':
    ave()
